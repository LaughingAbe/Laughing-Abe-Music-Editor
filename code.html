<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>ZIM - Code Creativity</title>
    <script src="https://zimjs.org/cdn/2.4.1/createjs.min.js"></script>
    <script src="https://zimjs.org/cdn/2.4.1/zim.min.js"></script>

    <!-- zimjs.com - JavaScript Canvas Framework -->
    <script type=module>
    

import zim from "https://zimjs.org/cdn/02/zim";


let windowWidth = 3224;  
let windowHeight = 2268;
let count = 0;              //  number of active/current note
let step = 100;             //  distance between notes on music staff
let size = step;            //  note palette button size
let Rout = size/2;          //  Outer radius of ring notation on music staff
let circleWidth = Rout*2; // Example width of the circle
let Rin = Rout*0.7;         //  Inner radius of ring notation on music staff
let Rim = Rout - Rin;       //  Ring thickness of ring notation on music staff  
let buttonY = 0;            //  Height of the pallette from the top
let soundsWritten = [];
let noteCentres = [];
let tabNotation = [];
let pianodots = [];
let noteNum = [];
let noteTimes = [];
let audios = [];
let duration = 6;           //playback speed
let colourBut = [red, orange, yellow, green, blue, purple, pink];
let coloursIn = [white, orange, white, green, white, white, pink, red, orange, yellow, green, blue, purple];
let coloursOut = [red, red, yellow, yellow, blue, purple, purple, purple, purple, purple, purple, purple, purple];
let solfa = ['Do', 'Re', 'Mi', 'Fa', 'So', 'La', 'Ti'];
let baseline = 700;         //  Centre of middle C on the music staff
let baselineTab = baseline*1.4;     //  top line of the tabs
let pianoDot1X = 100;               //  centre X of first dot on piano diagram
let pianoDot1Y = 1670;              //  centre y of first dot on piano diagram
let markedStringThickness = 15;     //  The string marked on the fretboard diagram
let fretboardDotSize = Rout*0.8;        //  The dots on the fretboard diagram
let lineStart = 0;//Rout;
let musicLineX = lineStart;
let musicLineY = 0; // Added Y position for the music line
let intervalID; // Variable to hold the interval ID
let scoreTotal = 0;         // Variable for calculating the total score
let maximumTotal = 0;
let scoreAvarage = 0;


function keydown_space(event) {
soundsWritten.push(' ');
noteCentres.push(' ');
noteNum.push(0);
count += step;
}
function keydwon_backspace(event) {
    count -= step;
    const lastItem = soundsWritten[soundsWritten.length - 1]
    const lastCentre = noteCentres[noteCentres.length - 1]
    lastItem.alp(0);
    lastCentre.alp(0);
    soundsWritten.pop();
    noteCentres.pop();
    noteNum.pop();
    noteTimes.pop();
}

// See Docs under Frame for FIT, FILL, FULL, and TAG
let frame = new Frame(FIT, windowWidth, windowHeight, light, dark, ready);
let stage = frame.stage;

function showFeedbackMessage(message, color) {
        // Create a Label with the provided message and color
        STYLE = {text:message, color:color};
        let feedbackLabel = new Label()
            .center(stage); // Center the label on the stage
            //.regX(feedbackLabel.width / 2) // Set the registration point to the center horizontally
            //.regY(feedbackLabel.height / 2); // Set the registration point to the center vertically
         // Calculate the center point of the label
        let centerX = feedbackLabel.width / 2;
        let centerY = feedbackLabel.height / 2;

        // Set the registration point to the calculated center
        feedbackLabel.regX = centerX;
        feedbackLabel.regY = centerY;

        // Animate the label to grow larger and fade out
        feedbackLabel.animate({
            props: { scaleX: 8, scaleY: 8, alpha: 1 }, // Scale up and fade in
            time: 0.5, // Animation duration in seconds
            rewind: true, // Reverse the animation (fade out)
            call: () => {
                // Remove the label from the stage after the animation
                feedbackLabel.removeFrom(stage);
            }
        });
    }

    STYLE = {black};


// Define constants for scoring
const FULL_SCORE_PERCENTAGE = 1; // 100%
const CLOSE_SCORE_PERCENTAGE = 0.75; // 75%
const FAR_SCORE_PERCENTAGE = 0.25; // 25%

// Function to calculate the score based on the distance between the line and the circle
function calculateScore(lineX, circleX, width) {
    let distance = Math.abs(lineX - circleX); // Calculate the distance between the line and the circle
    
    let maxDistance = width / 2; // Calculate the maximum distance (half of the width of the circle)
    console.log('Distance:', distance);
    console.log('Max Distance:', maxDistance);

    let percentage = (distance / Rout) * 100; // Calculate the percentage relative to the note radius

    // Determine the score based on the percentage
    if (percentage <= 15) {
        // Example usage:
        showFeedbackMessage("Perfect!", "blue");
        return 1; // 100% score if the percentage is less than or equal to 15%
    } else if (percentage <= 50) {
        showFeedbackMessage("Excellent!", "green");
        return 0.8; // 80% score if the percentage is between 15% and 50%
    } else if (percentage <= 80) {
        showFeedbackMessage("Great", "yellow");
        return 0.5; // 50% score if the percentage is between 50% and 80%
    } else if (percentage <= 100) {
        showFeedbackMessage("Nice!", "orange");
        return 0.2; // 20% score if the percentage is between 80% and 100%
    } else {
        showFeedbackMessage("Whoopsie!", "Red");
        return -0.1; // -10% score (penalty) if the percentage is greater than 100%
    }
}

function ready() {
    // Create a variable to hold the music line
    let musicLine;
    var stage = frame.stage;
    let scoreText = new Label("Total Score: 0")
        .pos(stage.width - 300, 40);
    console.log("scoreText:", scoreText.text); // Log the scoreText's text
    let scoreAvarageText = new Label("Average: 0")
        .pos(stage.width - 300, 140);
    console.log("scoreAvarageText:", scoreAvarageText.text); // Log the scoreText's text

    // Create a text object for the countdown
    let countdownText = new Label({
        text: "3", // Initial text
        size: 100, // Font size (adjust as needed)
        font: "Arial", // Font family
        color: "black" // Text color
    })
        .center() // Position in the center of the stage
        .addTo(stage); // Add to the stage

    // Function to update the countdown text
    function updateCountdownText(text) {
        countdownText.text = text;
    }

    // set the position of the listen button
    let listenButtonX = 1600;
    let listenButtonY = 800;
    // Create the Listen button
    let listenButton = new Button(200, 100, "Listen", black)
        .pos(listenButtonX, listenButtonY)
        .addTo(stage);

    // Function to handle the automatic playback
    function startAutomaticPlayback() {
        // Disable tapping on the notes
        console.log(`AutomaticPlayback started`);
        disableNoteInteraction();

        // Start an interval to play the notes automatically
        intervalID = setInterval(() => {
            // Check if the line is at a note position
            let posnum = (musicLineX-lineStart)/size;         //The position of the line by dividing the distance from the start by the distance between notes
            if ((musicLineX-lineStart)%(size) == 0){            // If the line is at one of the notes
                // Play the audio for the note at the current position
                playAudio(noteNum[posnum]);
                explodeNote(soundsWritten[posnum]);
                explodeNote(noteCentres[posnum]);
            }

            // Move the music line
            musicLineX += 2; // Adjust the increment as needed
            musicLine.pos(musicLineX, musicLineY);  // Update position of the Line on the screen

            // Update the screen
            stage.update();
        }, 10); // Adjust the interval duration as needed
    }

        // Function to disable manual interaction with the notes
        function disableNoteInteraction() {
            // Iterate over each note button and remove its tap event listener
            soundsWritten.forEach(noteButton => {
                noteButton.removeAllEventListeners('tap');
            });

            noteCentres.forEach(noteButton => {
                noteButton.removeAllEventListeners('tap');
            });
        }

        // Function to stop the automatic playback
        function stopAutomaticPlayback() {
            // Clear the interval
            clearInterval(intervalID);

            // Enable manual interaction with the notes
            enableNoteInteraction();
        }

        // Function to enable manual interaction with the notes
        function enableNoteInteraction() {
            // Iterate over each note button and reattach its tap event listener
            soundsWritten.forEach(noteButton => {
                noteButton.tap(() => {
                    explodeNote(noteButton);
                });
            });

            noteCentres.forEach(noteButton => {
                noteButton.tap(() => {
                    explodeNote(noteButton);
                });
            });
        }

        // Event listener for the Listen button
        listenButton.on("click", () => {
            startAutomaticPlayback();
        });

    // Create a function to initialize the music line
    function initMusicLine() {
        // Create music time line at its initial position of the first note 
        musicLine = new Rectangle(10, windowHeight, black).loc(musicLineX, musicLineY);
    }

    // Call the initMusicLine function to initialize the music line
    initMusicLine();

    document.addEventListener('keydown', function (event) {
        console.log(`Keydown event fired ${event.key}`);
        switch (event.code) {
            case 'Space':
                keydown_space(event);
                break;
            case 'Backspace':
                keydwon_backspace();
                break;
        }      
    }); 

    // Add event listener for tick events (animation loop)
    frame.on("tick", () => {
        // Update the position of the music line
        musicLine.pos(musicLineX, musicLineY);
        //musicLineX += 1; // Increment X position here
        // Update the screen
        stage.update();
    });

    let counting = 0;
    let iCount = 0;

    //Draw the 5 lines of the music staff
    let staffLineWidth = 3;
    for (let i = 0; i < 5; i++) {
        new Rectangle(windowWidth, staffLineWidth, black).loc(0, baseline - Rout*(1 + 2*i));
    }

    //Draw the 4 lines of the tab notation
    //same line thickness as the music staff
    for (let i = 0; i < 4; i++) {
        new Rectangle(windowWidth, staffLineWidth, black).loc(0, baselineTab + Rout*(1 + 2*i));
    }

    //Draw piano diagram white notes
    let pianoNoteWidth = 200;
    let pianoNoteHeight = 400;
    let pianoDiagramHeight = 1400;   // Starting height of piano notes
    let pianoDiagramXBuffer = 50;
    const pianoNotes = [];

    for (let i = 0; i < 14; i++) {
        const pianonote = new Rectangle(pianoNoteWidth, pianoNoteHeight, white)
                                .loc(pianoDiagramXBuffer + pianoNoteWidth * i, pianoDiagramHeight);
        pianonote.borderColor = black;
        pianonote.borderWidth = 5;
        pianoNotes.push(pianonote);
    }

    //Black notes on the piano
    const pianoBlackNoteWidth1 = pianoNoteWidth * 3 / 5;
    const pianoBlackNoteWidth2 = pianoNoteWidth * 4 / 7;
    const pianoBlackNoteHeight = 250;
    const pianoBlackNotes = [];

    // First loop for the first two black notes
    for (let i = 0; i < 2; i++) {
        const pianonote = new Rectangle(pianoBlackNoteWidth1, pianoBlackNoteHeight, black)
                                .loc(pianoDiagramXBuffer + pianoBlackNoteWidth1 * (2 * i + 1), pianoDiagramHeight);
        pianoBlackNotes.push(pianonote);
    }

    // Second loop for the next three black notes
    for (let i = 0; i < 3; i++) {
        const pianonote = new Rectangle(pianoBlackNoteWidth2, pianoBlackNoteHeight, black)
                                .loc(pianoDiagramXBuffer + pianoBlackNoteWidth2 * (2 * i + 1) + 3 * pianoNoteWidth, pianoDiagramHeight);
        pianoBlackNotes.push(pianonote);
    }

    // Draw the second group of 2 black notes
    for (let i = 0; i < 2; i++) {
        const pianonote = new Rectangle(pianoBlackNoteWidth1, pianoBlackNoteHeight, black)
                                .loc(pianoDiagramXBuffer + pianoBlackNoteWidth1 * (2 * i + 1)+pianoNoteWidth*7, pianoDiagramHeight);
        pianoBlackNotes.push(pianonote);
    }

    // Second loop for the next three black notes
    for (let i = 0; i < 3; i++) {
        const pianonote = new Rectangle(pianoBlackNoteWidth2, pianoBlackNoteHeight, black)
                                .loc(pianoDiagramXBuffer + pianoBlackNoteWidth2 * (2 * i + 1) + 3 * pianoNoteWidth+pianoNoteWidth*7, pianoDiagramHeight);
        pianoBlackNotes.push(pianonote);
    }

    //Draw fretboard diagram
    //Draw 4 strings
    let fretboardWidth = 600*3;
    let fretboardHeight = 300;
    let numberOfFrets = 12;
    let fretWidth = fretboardWidth/numberOfFrets;
    let fretboardYStart = 1900;
    let fretboardXStart = 80;
    let tabLineSpace = size;
    let fretboardStringX1 = 100;

    for (let i = 0; i < 4; i++) {
        new Rectangle(fretboardWidth, staffLineWidth, black).loc(fretboardXStart, fretboardYStart+i*tabLineSpace);
    }

    //Draw nut on fretboard
    const nutBufferWidth = 10;
    let nutWidth = 30;
    let nutBorderWidth = staffLineWidth;
    const nut = new Rectangle(nutWidth, fretboardHeight, white).loc(fretboardXStart-nutBufferWidth, fretboardYStart);
    nut.borderColor = black;
    nut.borderWidth = nutBorderWidth;

    //Draw frets
    let fretWireWidth = 10;
    for(let i = 0; i<numberOfFrets; i++){
        new Rectangle(fretWireWidth, fretboardHeight, black).loc(fretboardXStart+fretWidth*(1+i), fretboardYStart);
    } 
    
    // Define arrays to store references to exploded notes and faded out notes
    let explodedNotes = [];
    let fadedOutNotes = [];

    function explodeNote(note) {
        // Animate the explosion effect directly on the note (Circle) object
        if(note){    
            note.animate({
                props: { scaleX: 6, scaleY: 6, alpha: 0 }, // Scale up and fade out
                time: 0.5, // Duration of the animation in seconds
                loop: false, // Play the animation only once
                rewind: false, // Do not rewind the animation after it finishes
                call: () => {
                    // Remove the note from the stage after the explosion animation
                    note.removeFrom(stage);
                    // Add the exploded note to the explodedNotes array
                    explodedNotes.push(note);
                    //console.log("Note exploded and stored:", note);
                }
            });
        }
    }

    function fadeOutNote(note) {
        // Animate the fade-out effect on the note (Circle) object
        if(note){
            note.animate({
                props: { alpha: 0 }, // Fade out
                time: 1, // Duration of the animation in seconds
                loop: false, // Play the animation only once
                rewind: false, // Do not rewind the animation after it finishes
                call: () => {
                    // Remove the note from the stage after the fade-out animation
                    note.removeFrom(stage);
                    // Add the faded out note to the fadedOutNotes array
                    fadedOutNotes.push(note);
                    console.log("Note faded out and stored:", note);
                }
            });
        };
    }

    // Function to update the score text
    function updateScoreTotal(scoreTotal) {
        scoreText.text = "Total: " + scoreTotal; // Update the text content with the new score
        stage.update();
    }

    // Function to update the score text
    function updateScoreAverage(scoreAverage) {
        scoreAvarageText.text = "Average: " + scoreAverage; // Update the text content with the new score
        stage.update();
    }

    function scoreExplodeButtonClick(circle, lineStart, musicLineX, circleWidth, count, soundsArray, centresArray) {
        let position = (circle.x - lineStart - Rout) / size;
        let scorePercentage = calculateScore(musicLineX, circle.x, circleWidth);
        let score = scorePercentage * 100;
        scoreTotal += score;
        maximumTotal = 100 * count;
        let scoreAverage = scoreTotal / maximumTotal * 100;
        updateScoreTotal(scoreTotal);
        updateScoreAverage(scoreAverage);
        explodeNote(soundsArray[position]);
        explodeNote(centresArray[position]);
    }

    // Function to reset the exploded notes
    function resetExplodedNotes() {
        // Iterate over the exploded notes array
        explodedNotes.forEach(note => {
            // Reset the scaleX and scaleY properties to their original values
            note.scaleX = 1;
            note.scaleY = 1;

            // Add the exploded note back to the stage
            stage.addChild(note);
            note.alpha = 1;
        });

        // Clear the explodedNotes array
        explodedNotes = [];
    }

    // Function to reset the faded out notes
    function resetFadedOutNotes() {
        // Iterate over the faded out notes array
        fadedOutNotes.forEach(note => {

            // Reset the scaleX and scaleY properties to their original values
            note.scaleX = 1;
            note.scaleY = 1;

            // Add the faded out note back to the stage
            stage.addChild(note);
            // Optionally, reset any properties of the note (position, alpha, etc.)
            note.alpha = 1; // Reset alpha to make the note visible again
        });

        // Clear the fadedOutNotes array
        fadedOutNotes = [];
    }

    //Create play button 
    let playButtonWidth = 200;
    let playButtonHeigth = 100;
    let playButtonX1 = 400;
    let playButtonY1 = 800;

    new Button(playButtonWidth,playButtonHeigth,"Play",black).pos(playButtonX1,playButtonY1).tap(()=>{
         // Iterate over each note button and attach the explosion effect to its tap event
        soundsWritten.forEach(noteButton => {
            noteButton.tap(() => {
                // Call the explodeNote function when the note button is tapped
                explodeNote(noteButton);
                //explodeNoteAndCounterpart(noteButton);
            });
        });

        noteCentres.forEach(noteButton => {
            noteButton.tap(() => {
                // Call the explodeNote function when the note button is tapped
                explodeNote(noteButton);
                //explodeNoteAndCounterpart(noteButton);
            });
        });

        startCountdown();
    });

        // Function to start the countdown
        function startCountdown() {
            // Start the countdown animation
            let countdown = 3;
            let countdownInterval = setInterval(() => {
                if (countdown > 0) {
                    // Update the countdown text
                    updateCountdownText(countdown.toString());
                    // Animate the countdown text (optional)
                    countdownText.animate({
                        props: { scaleX: 2, scaleY: 2 }, // Scale up
                        time: 0.5, // Duration of the animation in seconds
                        loop: false, // Play the animation only once
                        rewind: false // Do not rewind the animation after it finishes
                    });
                    countdown--;
                } else {
                    // Update the countdown text to "Go!"
                    updateCountdownText("Go! Click on the notes when the line meet their centres");
                    // Animate the countdown text (optional)
                    countdownText.animate({
                        props: { scaleX: 2, scaleY: 2 }, // Scale up
                        time: 0.5, // Duration of the animation in seconds
                        loop: false, // Play the animation only once
                        rewind: false, // Do not rewind the animation after it finishes
                        call: () => {
                            // Perform any additional actions after the countdown finishes
                            // For example, start moving the line forward
                            startLineMovement();
                            // Clear the countdown interval
                            clearInterval(countdownInterval);
                            // Remove the countdown text (optional)
                            countdownText.removeFrom(stage);
                        }
                    });
                }
                // Center the countdown text
                countdownText.center(stage);
            }, 1000); // Interval duration: 1 second (1000 milliseconds) 
        }                       
        
        function startLineMovement() {
            // Start the interval to update the music line's position
            intervalID = setInterval(() => {
                if (musicLineX == lineStart){
                    //playAudio(noteNum[0]);
                    //explodeNote(soundsWritten[0]);
                    //explodeNote(noteCentres[0]);
                    fadeOutNote(soundsWritten[0]);
                    fadeOutNote(noteCentres[0]);
                }

                musicLine.pos(musicLineX, musicLineY);
                //new Rectangle(10, windowHeight, yellow).loc(musicLineX, musicLineY);
                //musicLineX = lineStart + noteTime;
                musicLineX += 2;//2;//100; // Increment X position here  1.95 worked well for CCCCDDDDEEEEFFFFGGGG
                stage.update();
                
                if (musicLineX > windowWidth){
                    clearInterval(intervalID);
                }

                //play the next note and let the note explode as the line passes
                let posnum = (musicLineX-lineStart)/size;         //The position of the line by dividing the distance from the start by the distance between notes
                
                if ((musicLineX-lineStart)%(size) == 0){        //if position number is an integer, the line has moved a to the next note

                    //playAudio(noteNum[posnum]);                 //play note on music staff
                    //explodeNote(soundsWritten[posnum]);         //explode ring of note on music staff
                    //explodeNote(noteCentres[posnum]);           //explode centre of note on music staff
                    fadeOutNote(soundsWritten[posnum]);
                    fadeOutNote(noteCentres[posnum]);
                    
                }
                
            }, 10); // Set the interval duration to match your note timing
        
        }

        // // Start the countdown when the Play Game button is clicked
        // playGameButton.on("click", () => {
        //     startCountdown();
        // });

        // Function to stop the interval when needed (optional)
        function stopInterval() {
            clearInterval(intervalID);
        }

        // Function to play audio based on note tone
        function playAudio(noteTone) {
            console.log('Playing audio for note tone:', noteTone); // Log the note tone being played
            let audio = new Audio();

            switch (noteTone) {
                case 1:
                    audio.src = 'C-[AudioTrimmer.com].wav';
                    break;
                case 2:
                    audio.src = 'D-[AudioTrimmer.com].wav';
                    break;
                case 3:
                    audio.src = 'E-[AudioTrimmer.com].wav';
                    break;
                case 4:
                    audio.src = 'F-[AudioTrimmer.com].wav';
                    break;
                case 5:
                    audio.src = 'G-[AudioTrimmer.com].wav';
                    break;
                case 6:
                    audio.src = 'A-[AudioTrimmer.com].wav';
                    break;
                case 7:
                    audio.src = 'B-[AudioTrimmer.com].wav';
                    break;
                case 8:
                    audio.src = 'C1-[AudioTrimmer.com].wav';
                    break;
                case 9:
                    audio.src = 'D1-[AudioTrimmer.com].wav';
                    break;
                case 10:
                    audio.src = 'E1-[AudioTrimmer.com].wav';
                    break;
                case 11:
                    audio.src = 'F1-[AudioTrimmer.com].wav';
                    break;
                case 12:
                    audio.src = 'G1-[AudioTrimmer.com].wav';
                    break;
                case 13:
                    audio.src = 'A1-[AudioTrimmer.com].wav';
                    break;
                // Add cases for other note tones
                default:
                    // Handle unknown note tones
                    break;
            }
            audio.play();
            //stage.update();
        }

    //create red button
    new Button(size,size,"Do",red).pos(0,buttonY).tap(()=>{
        if(event.ctrlKey){
            count -= step;
        }

        //play the sound when the button is pressed
        var audio = new Audio('C-[AudioTrimmer.com].wav');
        audio.play();

        //register tone 1
        noteNum.push(1);
        noteTimes.push(count);
        audios.push("'C-[AudioTrimmer.com].wav'");

        //play the sound when the outer ring is pressed 
        soundsWritten.push(
            new Circle(Rout, red).pos(count,baseline).tap((event)=>{
                let circle = event.currentTarget; // Get the ZIM Circle object
                var audio = new Audio('C-[AudioTrimmer.com].wav');
                let position = (circle.x - lineStart - Rout)/size;
                let scorePercentage = calculateScore(musicLineX, circle.x, circleWidth);
                let score = scorePercentage * 100; // Convert percentage to actual score
                scoreTotal += score;                //Calculate total score
                maximumTotal = maximumTotal + 100;
                scoreAvarage = scoreTotal / maximumTotal*100;
                updateScoreTotal(scoreTotal);
                updateScoreAverage(scoreAvarage);
                explodeNote(soundsWritten[position]);
                explodeNote(noteCentres[position]);
                audio.play();
            })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
        noteCentres.push(
            new Circle(Rin, white).pos(count+Rim, baseline+Rim).tap((event)=>{
                let circle = event.currentTarget; // Get the ZIM Circle object
                var audio = new Audio('C-[AudioTrimmer.com].wav');
                let position = (circle.x - lineStart - Rout)/size;
                let scorePercentage = calculateScore(musicLineX, circle.x, circleWidth);
                let score = scorePercentage * 100; // Convert percentage to actual score
                scoreTotal += score;                //Calculate total score
                maximumTotal = 100*count;
                scoreAvarage = scoreTotal / maximumTotal *100;
                updateScoreTotal(scoreTotal);
                updateScoreAverage(scoreAvarage);
                explodeNote(soundsWritten[position]);
                explodeNote(noteCentres[position]);
                audio.play();
            })
        );

        //writing the tab notation
        tabNotation.push(
            new Button(size,size,"0",red).pos(count, baselineTab + Rout*4).tap(()=>{
                var audio = new Audio('C-[AudioTrimmer.com].wav');
                audio.play();
            })
        ); 
        
        //marking notes on piano
        pianodots.push(
            new Circle(Rout, red).pos(pianoDot1X, pianoDot1Y).tap(()=>{
                var audio = new Audio('C-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        new Rectangle(fretboardWidth- nutBufferWidth, markedStringThickness, red).loc(fretboardStringX1, fretboardYStart+2*size - markedStringThickness/2);

        count += step;
        
    });

    //Create orange button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"Re",orange).pos(size*1,buttonY).tap(()=>{

        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('D-[AudioTrimmer.com].wav');
         audio.play();

         //register tone 2
         noteNum.push(2);
         noteTimes.push(count);
         audios.push("'D-[AudioTrimmer.com].wav'");

        //play the sound when the outer ring is pressed 
        soundsWritten.push(
         new Circle(Rout,red).pos(count, baseline - Rout).tap((event)=>{           
            var audio = new Audio('D-[AudioTrimmer.com].wav');
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
            audio.play();
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
           new Circle(Rin,orange).pos(count + Rim, baseline + Rim - Rout).tap((event)=>{
                var audio = new Audio('D-[AudioTrimmer.com].wav');
                scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
                audio.play();
           })
         );

         //writing the tab notation
        tabNotation.push(
            new Button(size,size,"2",orange).pos(count, baselineTab + Rout*4).tap(()=>{
                var audio = new Audio('D-[AudioTrimmer.com].wav');
                audio.play();
            })
        ); 

        //marking notes on piano
        pianodots.push(
            new Circle(Rout, orange).pos(pianoDot1X+ pianoNoteWidth*1, pianoDot1Y).tap(()=>{
                var audio = new Audio('D-[AudioTrimmer.com].wav');
                audio.play();
            })
        );
        

        //marking the notes on the fretboard
        new Circle(fretboardDotSize, orange).loc(85+fretWidth*(1.5), fretboardYStart+2*tabLineSpace);
         count += step;
    });

    //Create yellow button that plays the sound when pressed and creates a new note symbol on the canvas
    const buttonMi = new Button(size,size,"Mi",yellow).pos(size*2,buttonY).tap(()=>{

        if(event.ctrlKey){
            count -= step;
        }

        //play the sound when the button is pressed
         var audio = new Audio('E-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(3);
         noteTimes.push(count);
         audios.push("'E-[AudioTrimmer.com].wav'");
        //zog(noteNum);

        //play the sound when the outer ring is pressed 
        soundsWritten.push(
            new Circle(Rout,yellow).pos(count, baseline-2*Rout).tap((event)=>{
                var audio = new Audio('E-[AudioTrimmer.com].wav');
                audio.play();
                scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
            })
        );

        //play the sound when the inner ring is pressed or leave out if it is an open string
        noteCentres.push(
            new Circle(Rin,white).pos(count+Rim, baseline-2*Rout+Rim).tap((event)=>{
                var audio = new Audio('E-[AudioTrimmer.com].wav');
                audio.play();
                scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
            })
        );

         //writing the tab notation
        tabNotation.push(
            new Button(size,size,"0",yellow).pos(count, baselineTab + Rout*2).tap(()=>{
                var audio = new Audio('E-[AudioTrimmer.com].wav');
                audio.play();
            })
        );
        
        //marking notes on piano
        pianodots.push(
            new Circle(Rout, yellow).pos(pianoDot1X+ pianoNoteWidth*2, pianoDot1Y).tap(()=>{
                var audio = new Audio('E-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        new Rectangle(fretboardWidth- nutBufferWidth, markedStringThickness, yellow).loc(fretboardStringX1, fretboardYStart+1*size - markedStringThickness/2);
    
         count += step;
    });

    //Create green button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"Fa",green).pos(size*3,buttonY).tap(()=>{

        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('F-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(4);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed 
        soundsWritten.push(
         new Circle(Rout,yellow).pos(count, baseline-(3)*Rout).tap((event)=>{
            var audio = new Audio('F-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
         new Circle(Rin,green).pos(count+Rim, baseline-3*Rout+Rim).tap((event)=>{
            var audio = new Audio('F-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
         );

        //writing the tab notation
        tabNotation.push(
            new Button(size,size,"1",green).pos(count, baselineTab + Rout*2).tap(()=>{
                var audio = new Audio('F-[AudioTrimmer.com].wav');
                audio.play();
            })
        ); 

         //marking notes on piano
         pianodots.push(
            new Circle(Rout, green).pos(pianoDot1X+ pianoNoteWidth*3, pianoDot1Y).tap(()=>{
                var audio = new Audio('F-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        new Circle(fretboardDotSize, green).loc(90+fretWidth*(0.5), fretboardYStart+1*tabLineSpace);
        //new Circle(Rout/2, green).loc(115+size/2, fretboardYStart+size);

         count += step;
    });

    //Create blue button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"So",blue).pos(size*4,buttonY).tap(()=>{

        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('G-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(5);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed
        soundsWritten.push( 
         new Circle(Rout,blue).pos(count, baseline-4*Rout).tap((event)=>{
            var audio = new Audio('G-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
         new Circle(Rin,white).pos(count+Rim, baseline-4*Rout+Rim).tap((event)=>{
            var audio = new Audio('G-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
         );

        //writing the tab notation
        tabNotation.push(
            new Button(size,size,"0",blue).pos(count, baselineTab+ Rout*6).tap(()=>{
                var audio = new Audio('G-[AudioTrimmer.com].wav');
                audio.play();
            })
        ); 

        //marking notes on piano
        pianodots.push(
            new Circle(Rout, blue).pos(pianoDot1X+ pianoNoteWidth*4, pianoDot1Y).tap(()=>{
                var audio = new Audio('G-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        new Rectangle(fretboardWidth- nutBufferWidth, markedStringThickness, blue).loc(fretboardStringX1, fretboardYStart+3*size - markedStringThickness/2);
         
         count += step;
    });

    //Create navy button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"La",purple).pos(size*5,buttonY).tap(()=>{

        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('A-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(6);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed
        soundsWritten.push( 
         new Circle(Rout,purple).pos(count, baseline-5*Rout).tap((event)=>{
            var audio = new Audio('A-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
         new Circle(Rin,white).pos(count+Rim, baseline-5*Rout+Rim).tap((event)=>{
            var audio = new Audio('A-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
         );

        //writing the tab notation
        tabNotation.push(
            new Button(size,size,"0",purple).pos(count, baselineTab + Rout*0).tap(()=>{
                var audio = new Audio('A-[AudioTrimmer.com].wav');
                audio.play();
            })
        );
        
        //marking notes on piano
        pianodots.push(
            new Circle(Rout, purple).pos(pianoDot1X+ pianoNoteWidth*5, pianoDot1Y).tap(()=>{
                var audio = new Audio('A-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        new Rectangle(fretboardWidth- nutBufferWidth, markedStringThickness, purple).loc(fretboardStringX1, fretboardYStart+0*size - markedStringThickness/2);

         count += step;
    });

     //Create pink button that plays the sound when pressed and creates a new note symbol on the canvas
     new Button(size,size,"Ti",pink).pos(6*size,buttonY).tap(()=>{

        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('B-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(7);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed 
        soundsWritten.push(
         new Circle(Rout,purple).pos(count, baseline-6*Rout).tap((event)=>{
            var audio = new Audio('B-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
         new Circle(Rin,pink).pos(count+Rim, baseline-6*Rout+Rim).tap((event)=>{
            var audio = new Audio('B-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
         );

        //writing the tab notation
        tabNotation.push(
            new Button(size,size,"2",pink).pos(count, baselineTab + Rout*0).tap(()=>{
                var audio = new Audio('B-[AudioTrimmer.com].wav');
                audio.play();
            })
        ); 

         //marking notes on piano
         pianodots.push(
            new Circle(Rout, pink).pos(pianoDot1X+ pianoNoteWidth*6, pianoDot1Y).tap(()=>{
                var audio = new Audio('B-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        new Circle(fretboardDotSize, pink).loc(85+fretWidth*(1.5), fretboardYStart+0*tabLineSpace);
        //new Circle(Rout/2, pink).loc(110+50+150, 1900);

         count += step;
    });

    //Create red button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"Do",red).pos(7*size,buttonY).tap(()=>{

        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('C1-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(8);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed
        soundsWritten.push( 
         new Circle(Rout,purple).pos(count, baseline-7*Rout).tap((event)=>{
            var audio = new Audio('C1-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
            new Circle(Rin,red).pos(count+Rim, baseline-7*Rout+Rim).tap((event)=>{
                var audio = new Audio('C1-[AudioTrimmer.com].wav');
                audio.play();
                scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
            })
         );

         //writing the tab notation
        tabNotation.push(
            new Button(size,size,"3",red).pos(count, baselineTab + Rout*0).tap(()=>{
                var audio = new Audio('C1-[AudioTrimmer.com].wav');
                audio.play();
            })
        ); 

         //marking notes on piano
         pianodots.push(
            new Circle(Rout, red).pos(pianoDot1X+ pianoNoteWidth*7, pianoDot1Y).tap(()=>{
                var audio = new Audio('C1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        //new Circle(Rout/2, red).loc(110+50+150+150, 1900);
        new Circle(fretboardDotSize, red).loc(85+fretWidth*(2.5), fretboardYStart+0*tabLineSpace);

         count += step;
    });

    //Create orange button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"Re",orange).pos(8*size,buttonY).tap(()=>{

        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('D1-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(9);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed
        soundsWritten.push( 
            new Circle(Rout,purple).pos(count, baseline-8*Rout).tap((event)=>{
                var audio = new Audio('D1-[AudioTrimmer.com].wav');
                audio.play();
                scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
            })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
            new Circle(Rin,orange).pos(count+Rim, baseline-8*Rout+Rim).tap((event)=>{
                var audio = new Audio('D1-[AudioTrimmer.com].wav');
                audio.play();
                scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
            })
         );

          //writing the tab notation
        tabNotation.push(
            new Button(size,size,"5",orange).pos(count, baselineTab + Rout*0).tap(()=>{
                var audio = new Audio('D1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );
        
        //marking notes on piano
        pianodots.push(
            new Circle(Rout, orange).pos(pianoDot1X+ pianoNoteWidth*8, pianoDot1Y).tap(()=>{
                var audio = new Audio('D1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

         //marking the notes on the fretboard
        new Circle(fretboardDotSize, orange).loc(85+fretWidth*(4.5), fretboardYStart+0*tabLineSpace);

         count += step;
    });

    //Create yellow button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"Mi",yellow).pos(9*size,buttonY).tap(()=>{
        
        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('E1-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(10);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed
        soundsWritten.push( 
         new Circle(Rout,purple).pos(count, baseline-9*Rout).tap((event)=>{
            var audio = new Audio('E1-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
         new Circle(Rin,yellow).pos(count+Rim, baseline+Rim-9*Rout).tap((event)=>{
            var audio = new Audio('E1-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
         );

          //writing the tab notation
        tabNotation.push(
            new Button(size,size,"7",yellow).pos(count, baselineTab + Rout*0).tap(()=>{
                var audio = new Audio('E1-[AudioTrimmer.com].wav');
                audio.play();
            })
        ); 

        //marking notes on piano
        pianodots.push(
            new Circle(Rout, yellow).pos(pianoDot1X+ pianoNoteWidth*9, pianoDot1Y).tap(()=>{
                var audio = new Audio('E1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

         //marking the notes on the fretboard
        new Circle(fretboardDotSize, yellow).loc(85+fretWidth*(6.5), fretboardYStart+0*tabLineSpace); 

         count += step;
    });

    //Create green button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"Fa",green).pos(10*size,buttonY).tap(()=>{
        
        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('F1-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(11);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed
        soundsWritten.push( 
         new Circle(Rout,purple).pos(count, baseline-10*Rout).tap((event)=>{
            var audio = new Audio('F1-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
            new Circle(Rin,green).pos(count+Rim, baseline+Rim-10*Rout).tap((event)=>{
                var audio = new Audio('F1-[AudioTrimmer.com].wav');
                audio.play();
                scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
            })
         );

          //writing the tab notation
        tabNotation.push(
            new Button(size,size,"8",green).pos(count, baselineTab + Rout*0).tap(()=>{
                var audio = new Audio('F1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking notes on piano
        pianodots.push(
            new Circle(Rout, green).pos(pianoDot1X+ pianoNoteWidth*10, pianoDot1Y).tap(()=>{
                var audio = new Audio('F1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

         //marking the notes on the fretboard
        new Circle(fretboardDotSize, green).loc(85+fretWidth*(7.5), fretboardYStart+0*tabLineSpace);
         
        count += step;
    });

    //Create green button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"So",blue).pos(11*size,buttonY).tap(()=>{
        
        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('G1-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(12);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed
        soundsWritten.push( 
         new Circle(Rout,purple).pos(count, baseline-11*Rout).tap((event)=>{
            var audio = new Audio('G1-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
         new Circle(Rin,blue).pos(count+Rim, baseline+Rim-11*Rout).tap((event)=>{
            var audio = new Audio('G1-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
         );

        //writing the tab notation
        tabNotation.push(
            new Button(size,size,"10",blue).pos(count, baselineTab + Rout*0).tap(()=>{
                var audio = new Audio('G1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );
        
        //marking notes on piano
        pianodots.push(
            new Circle(Rout, blue).pos(pianoDot1X+ pianoNoteWidth*11, pianoDot1Y).tap(()=>{
                var audio = new Audio('G1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        new Circle(fretboardDotSize, blue).loc(85+fretWidth*(9.5), fretboardYStart+0*tabLineSpace);

         count += step;
    });

    //Create green button that plays the sound when pressed and creates a new note symbol on the canvas
    new Button(size,size,"La",purple).pos(12*size,buttonY).tap(()=>{
        
        if(event.ctrlKey){
            count -= step;
        }
        
        //play the sound when the button is pressed
         var audio = new Audio('A1-[AudioTrimmer.com].wav');
         audio.play();
         noteNum.push(13);
         noteTimes.push(count);

        //play the sound when the outer ring is pressed
        soundsWritten.push( 
         new Circle(Rout,purple).pos(count, baseline-12*Rout).tap((event)=>{
            var audio = new Audio('A1-[AudioTrimmer.com].wav');
            audio.play();
            scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
         })
        );

         //play the sound when the inner ring is pressed or leave out if it is an open string
         noteCentres.push(
            new Circle(Rin,purple).pos(count+Rim, baseline+Rim-12*Rout).tap((event)=>{
                var audio = new Audio('A1-[AudioTrimmer.com].wav');
                audio.play();
                scoreExplodeButtonClick(event.currentTarget, lineStart, musicLineX, circleWidth, count, soundsWritten, noteCentres);
            })
         );

          //writing the tab notation
        tabNotation.push(
            new Button(size,size,"12",purple).pos(count, baselineTab + Rout*0).tap(()=>{
                var audio = new Audio('A1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking notes on piano
        pianodots.push(
            new Circle(Rout, purple).pos(pianoDot1X+ pianoNoteWidth*12, pianoDot1Y).tap(()=>{
                var audio = new Audio('A1-[AudioTrimmer.com].wav');
                audio.play();
            })
        );

        //marking the notes on the fretboard
        new Circle(fretboardDotSize, purple).loc(85+fretWidth*(11.5), fretboardYStart+0*tabLineSpace);

         count += step;
    });

    // Create a function to reset the game state
    function resetGameState() {
        // Stop the interval if it's running
        clearInterval(intervalID);

        // Reset the music line position
        musicLineX = lineStart;
        musicLine.pos(musicLineX, musicLineY);  // Update position of the Line on the screen

        // Reset any other variables or game state as needed

        // Clear any visual effects applied during playback
        // For example, remove any exploded notes or reset their appearance

        // Update the stage to reflect the reset state
        stage.update();
    }

    // set the position of the reset button
    let resetButtonX = 1000;
    let resetButtonY = 800;
    // Create the Reset button
    new Button(200, 100, "Reset", black)
        .pos(resetButtonX, resetButtonY)
        //.center()
        .tap(() => {
            // Call the reset function when the Reset button is pressed
            resetGameState();
            // Call the functions to reset the exploded notes and faded out notes
            resetExplodedNotes();
            resetFadedOutNotes();
        });

        function hasDuplicateEventListeners(object) {
        // Store all event listeners in an array
        let allEventListeners = object._listeners;

        // Track event listeners that have been encountered
        let encounteredEventListeners = {};

        // Iterate over each event type
        for (let eventType in allEventListeners) {
            if (allEventListeners.hasOwnProperty(eventType)) {
                // Get the list of event listeners for this event type
                let listeners = allEventListeners[eventType];

                // Iterate over each event listener
                listeners.forEach(listener => {
                    // Get the listener function
                    let listenerFunction = listener.listener;

                    // Check if this listener function has been encountered before
                    if (encounteredEventListeners[listenerFunction]) {
                        // Found a duplicate listener
                        console.log('Duplicate event listener found:', eventType);
                        console.log('Listener function:', listenerFunction);
                        return true; // Indicates that a duplicate was found
                    }

                    // Mark this listener function as encountered
                    encounteredEventListeners[listenerFunction] = true;
                });
            }
        }

        // No duplicate event listeners found
        console.log("No duplicate event listeners found");
        return false;
    }
    // Check for duplicate event listeners on soundsWritten
    if (hasDuplicateEventListeners(soundsWritten)) {
        console.log("Duplicate event listeners found on soundsWritten");
    }

    // Check for duplicate event listeners on noteCentres
    if (hasDuplicateEventListeners(noteCentres)) {
        console.log("Duplicate event listeners found on noteCentres");
    }
    
}
</script>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
</head>

<body></body>

</html>